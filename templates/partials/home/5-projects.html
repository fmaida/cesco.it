<!-- section works -->
{% from "partials/home/macros/responsive_image.html" import responsive_image %}
<section id="works">

    <div class="container">

        <!-- section title -->
        <h2 class="section-title wow fadeInUp">{{ t["Recent works"] }}</h2>

        <div class="spacer" data-height="{{ params.settings.space }}"></div>

        {% if params.projects.description %}
        <div class="col-12 ms-3 me-3">{{ params.projects.description | markdown }}</div>
        {% endif %}

        <!-- projects filter (desktop) -->
        <ul class="portfolio-filter list-inline wow fadeInUp ms-3 me-3">
            <li class="current list-inline-item" data-filter="*">{{ t["Everything"] }}</li>
            {% for tag in params.projects.tags %}
            <li class="list-inline-item" data-filter=".{{ tag | lower() }}">{{ tag | replace("_", " ") | title() }}</li>
            {% endfor %}
            {#
            <li class="list-inline-item" data-filter=".art">Art</li>
            <li class="list-inline-item" data-filter=".design">Design</li>
            <li class="list-inline-item" data-filter=".branding">Branding</li>
            #}
        </ul>

        <!-- portfolio filter (mobile) -->
        <div class="pf-filter-wrapper">
            <select class="portfolio-filter-mobile">
                <option value="*">{{ t["Everything"] }}</option>
                {% for tag in params.tags %}
                <option value=".{{ tag | lower() }}">{{ tag }}</option>
                {% endfor %}
                {#
                <option value=".creative">Creative</option>
                <option value=".art">Art</option>
                <option value=".design">Design</option>
                <option value=".branding">Branding</option>
                #}
            </select>
        </div>

        <!-- portolio wrapper -->
        <div class="row portfolio-wrapper">

            {% for work in params.projects.projects %}
            {% set image_full = work.image %}
            {% if work.image_path %}
                {% set image_full = work.image_path ~ "__1600.jpg" %}
            {% else %}
                {% set image_full = work.image[1:] if work.image and work.image.startswith('/') else work.image %}
            {% endif %}
            <!-- portfolio item -->
            <div class="col-md-4 col-sm-6 grid-item {% for tag in work.tags %}{{ tag | lower() }}{% if not loop.last %} {% endif %}{% endfor %}">
                {% if ".mp4" not in work.image %}
                <a href="{{ url_for('static', filename=image_full) }}" class="work-image">
                {% endif %}
                    <div class="portfolio-item rounded shadow-dark">
                        <div class="details">
                            <span class="term">{% for tag in work.tags %}{{ tag | replace("_", " ") }}{% if not loop.last %}, {% endif %}{% endfor %}</span>
                            <h4 class="title">{{ work.title }}</h4>
                            <span class="more-button"><i class="icon-magnifier-add"></i></span>
                        </div>
                        <div class="thumb">
                            {% if work.image_path %}
                                {% set w, h = work.aspect_ratio.split(':') %}
                                {% set width = 400 %}
                                {% set height = (width * (h|float / w|float))|int %}
                                {{ responsive_image(work.image_path, work.title, width=width, height=height, aspect_ratio=work.aspect_ratio) }}
                            {% else %}
                                {% if ".mp4" in work.image %}
                                    <video autoplay muted playsinline
                                           webkit-playsinline loop preload="metadata"
                                           width="384" height="384">
                                        <source src="{{ url_for('static', filename=work.image[1:] if work.image and work.image.startswith('/') else work.image) }}" type="video/mp4">
                                        Il tuo browser non supporta i video HTML5.
                                    </video>
                                {% else %}
                                    <img src="{{ url_for('static', filename=work.image[1:] if work.image and work.image.startswith('/') else work.image) }}" class="img-fluid" width="400" alt="Portfolio-title" />
                                {% endif %}
                            {% endif %}
                            <div class="mask"></div>
                        </div>
                    </div>
                {% if ".mp4" not in work.image %}
                </a>
                {% endif %}
            </div>
            {% endfor %}

            {# Tutto quello che segue probabilmente Ã¨ da cancellare #}
            {#
            <!-- portfolio item -->
            <div class="col-md-4 col-sm-6 grid-item creative design">
                <a href="#small-dialog" class="work-content">
                    <div class="portfolio-item rounded shadow-dark">
                        <div class="details">
                            <span class="term">Creative</span>
                            <h4 class="title">Guest App Walkthrough Screens</h4>
                            <span class="more-button"><i class="icon-options"></i></span>
                        </div>
                        <div class="thumb">
                            <img src="https://via.placeholder.com/330x267" alt="Portfolio-title" />
                            <div class="mask"></div>
                        </div>
                    </div>
                </a>
                <div id="small-dialog" class="white-popup zoom-anim-dialog mfp-hide">
                    <img src="https://via.placeholder.com/590x280" alt="Title" />
                    <h2>Guest App Walkthrough Screens</h2>
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam hendrerit nibh in massa semper rutrum. In rhoncus eleifend mi id tempus.</p>
                    <p>Donec consectetur, libero at pretium euismod, nisl felis lobortis urna, id tristique nisl lectus eget ligula.</p>
                    <a href="#" class="btn btn-default">View on Dribbble</a>
                </div>
            </div>

            <!-- portfolio item -->
            <div class="col-md-4 col-sm-6 grid-item branding">
                <a href="https://www.youtube.com/watch?v=qf9z4ulfmYw" class="work-video">
                    <div class="portfolio-item rounded shadow-dark">
                        <div class="details">
                            <span class="term">Branding</span>
                            <h4 class="title">Delivery App Wireframe</h4>
                            <span class="more-button"><i class="icon-camrecorder"></i></span>
                        </div>
                        <div class="thumb">
                            <img src="https://via.placeholder.com/330x267" alt="Portfolio-title" />
                            <div class="mask"></div>
                        </div>
                    </div>
                </a>
            </div>

            <!-- portfolio item -->
            <div class="col-md-4 col-sm-6 grid-item creative">
                <a href="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/240233494&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true" class="work-video">
                    <div class="portfolio-item rounded shadow-dark">
                        <div class="details">
                            <span class="term">Creative</span>
                            <h4 class="title">Onboarding Motivation</h4>
                            <span class="more-button"><i class="icon-music-tone-alt"></i></span>
                        </div>
                        <div class="thumb">
                            <img src="https://via.placeholder.com/330x267" alt="Portfolio-title" />
                            <div class="mask"></div>
                        </div>
                    </div>
                </a>
            </div>

            <!-- portfolio item -->
            <div class="col-md-4 col-sm-6 grid-item art branding">
                <a href="#gallery-1" class="gallery-link">
                    <div class="portfolio-item rounded shadow-dark">
                        <div class="details">
                            <span class="term">Art, Branding</span>
                            <h4 class="title">iMac Mockup Design</h4>
                            <span class="more-button"><i class="icon-picture"></i></span>
                        </div>
                        <div class="thumb">
                            <img src="https://via.placeholder.com/330x267" alt="Portfolio-title" />
                            <div class="mask"></div>
                        </div>
                    </div>
                </a>
                <div id="gallery-1" class="gallery mfp-hide">
                    <a href="https://via.placeholder.com/330x267"></a>
                    <a href="https://via.placeholder.com/330x267"></a>
                </div>
            </div>

            <!-- portfolio item -->
            <div class="col-md-4 col-sm-6 grid-item creative design">
                <a href="https://themeforest.net/user/pxlsolutions/portfolio" target="_blank">
                    <div class="portfolio-item rounded shadow-dark">
                        <div class="details">
                            <span class="term">Creative, Design</span>
                            <h4 class="title">Game Store App Concept</h4>
                            <span class="more-button"><i class="icon-link"></i></span>
                        </div>
                        <div class="thumb">
                            <img src="https://via.placeholder.com/330x267" alt="Portfolio-title" />
                            <div class="mask"></div>
                        </div>
                    </div>
                </a>
            </div>

            #}

        </div>

        {#
        <!-- more button -->
        <div class="load-more text-center mt-4">
            <a href="javascript:" class="btn btn-default"><i class="fas fa-spinner"></i> {{ t["Load more"] }}</a>
            <!-- numbered pagination (hidden for infinite scroll) -->
            <ul class="portfolio-pagination list-inline d-none">
                <li class="list-inline-item">1</li>
                <li class="list-inline-item"><a href="works-2.html">2</a></li>
            </ul>
        </div>
        #}
    </div>

</section>